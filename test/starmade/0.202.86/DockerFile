FROM ubuntu:22.04

MAINTAINER tux-box <nathan.flow@gmail.com>

RUN apt-get update && apt-get install -y apache2 && apt-get clean && rm -rf /var/lib/apt/lists/*

#persistant storage?
# Usage: VOLUME ["/dir_1", "/dir_2" ..]
#VOLUME ["/my_files"]

ENV RUN_USER  starmade
ENV RUN_GROUP starmade
ENV LOG_DIR   /var/log/starmade
ENV PID_FILE  /var/run/starmade/starmade.pid
ENV RUN_DIR   /var/run/starmade
ENV LOCK_DIR  /var/lock/starmade

RUN mkdir -p $RUN_DIR
RUN mkdir -p $LOCK_DIR
RUN mkdir -p $LOG_DIR

COPY StarMadeInstallerFile.sh $RUN_DIR
COPY StarMadeServerStart.sh $RUN_DIR

#run commands directly rather than from file.
WORKDIR /var/run/starmade
CMD ["sudo apt install openjdk-8-jre-headless -y"]
CMD ["wget  https://files.star-made.org/StarMade-Starter.jar"]
CMD ["./StarMade-Starter.jar -nogui","-D", "FOREGROUND"]
ENTRYPOINT ["java -jar"]

EXPOSE 4242